# Practice with redis

## Подготовка Redis

```
docker run `
  --name otus-redis-7.2 `
  -v "$(pwd)/redis.conf:/etc/redis/redis.conf" `
  -p 6379:6379 `
  -d `
  redis:7.2.5 redis-server /etc/redis/redis.conf
```

```shell
docker start otus-redis-7.2
```

```shell
docker exec -it otus-redis-7.2 redis-cli
```

## Подготовка данных

Выкачал тестовый json [file](./20mb.json) и поместил в репозиторий.

## Тестирование загрузки json в разные структуры Redis

Подготовил скрипт [скрипт](./test%202.py) для тестирования записи в Redis данного JSON.
Чтение поля, это чтение первого попавшегося поля, не поиск элемента по конкретным полям.

Получил результат:
``` 
Тип      Запись   Чтение   Чт.поля  Диапазон Размер
------------------------------------------------------------
STRING   0.1779   0.2511   0.2513   -        22467.6
HASH     1.0669   0.5644   0.0000   0.1138331413269043 N/A
ZSET     1.2200   0.4133   0.0014   0.4133406639099121 N/A
LIST     0.9689   0.3794   0.0006   0.0012009620666503906 N/A
```

## Анализ результатов

#### String

Видно, что запись и чтение быстрее, чем в остальные структуры данных. Однако для чтения какого либо поля JSON строку 
необходимо десериализовать, что в некоторых кейсах не производительно. Также не поддерживает запросы по диапазону.
В строке удобно хранить JSON, если он используется целиком.

#### HASH

Видно, что при невысоком чтении и записи в целом. Диапазонные запросы не поддерживает. Чтение отдельных полей в этой 
структуре в идеале O(1) то есть самое быстрое.

#### ZSET

Хуже всех на записи, но зато поддерживает запросы по диапазонам. Чтение конкретного поля тоже быстрое за O(logn) исходя из структуры.

#### LIST

Лучше HASH или ZSET на записи/чтении и хорошо работает при последовательной обработке данных т.к. данные лежат рядом.
Хорошо подойдет для организации очереди.